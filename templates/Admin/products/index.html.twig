{% extends './base.html.twig' %}

{% block title %}Liste des produits{% endblock %}

{% block body %}


    <div class="container">
        <div class="row">

            <div class="justify-content-start">

                <a href="{{ path('admin_index') }}"
                   class="text-decoration-none">
                     <span>
                         <button class="btn btn-danger mt-2">
                         <i class="bi bi-arrow-left"></i>
                         Retour au Panel d'administration
                         </button>
                     </span>
                </a>
            </div>

            {% include "_template/_adminnav.html.twig" %}

            <main class="col-9 border border-light bg-white p-2">

                <h1>Liste des produits.</h1>

                <table class="table">
                    <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Nom</th>
                        <th scope="col">Photo</th>

                        <th class="d-none d-sm-table-cell ">Prix</th>
                        <th class="d-none d-sm-table-cell ">Stock</th>
                        <th class="d-none d-sm-table-cell ">Année</th>
                        <th class="d-none d-md-table-cell ">Modèle</th>
                        <th class="d-none d-lg-table-cell ">kilométrage</th>
                        <th class="d-none d-lg-table-cell ">Catégorie</th>

                        <th scope="col">Actions</th>
                    </tr>
                    </thead>

                    <tbody>
                    {% for produit in produits %}
                        <tr>

                            <td>{{ produit.id }}</td>
                            <td>{{ produit.name }}</td>
                            <td><img src="{{ asset('assets/images/uploads/products/mini/300-300-' ~ produit.images[0].name) }}"
                                     alt="{{ produit.name }}"
                                     class="img-thumbnail img-fluid"
                                     width="100"
                                     height="100"
                                ></td>

                            <td class="d-none d-sm-table-cell ">{{ produit.price / 100 }}</td>
                            <td class="d-none d-sm-table-cell ">{{ produit.stock }}</td>
                            <td class="d-none d-sm-table-cell ">{{ produit.years }}</td>
                            <td class="d-none d-md-table-cell ">{{ produit.modeles }}</td>
                            <td class="d-none d-lg-table-cell ">{{ produit.kilometrage }}</td>
                            <td class="d-none d-lg-table-cell ">{{ produit.categories.name }}</td>
                            <td>
                                <!-- Modification -->
                                <a href="{{ path('admin_products_edit',
                                    {id : produit.id}) }}" class="btn btn-danger btn-custom bi bi-pencil-square"></a>
                            </td>

                            <!-- Supression -->
                            <td>
                                <button
                                        class="btn btn-danger btn-custom bi-trash3-fill deleteBtn"
                                        data-bs-toggle="modal"
                                        data-bs-target="#deleteModal{{ produit.id }}"
                                        data-action="{{ path('admin_products_delete', {'id': produit.id}) }}">
                                </button>
                            </td>

                            <!-- Modal de suppression -->
                            <div class="modal fade" id="deleteModal{{ produit.id }}" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="deleteModalLabel">Confirmation de suppression</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            Êtes-vous sûr de vouloir supprimer {{produit.name}} ?
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                                            <form id="deleteForm{{ produit.id }}" action="{{ path('admin_products_delete', {'id': produit.id}) }}" method="POST">
                                                <input type="hidden" name="method" value="DELETE">
                                                <button type="submit" class="btn btn-danger">Supprimer</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>

            </main>

        </div>
    </div>


{% endblock %}
